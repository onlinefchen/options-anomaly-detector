# æ›´æ–°æ—¥å¿—

## 2025-10-30 (v3)

### æ–°å¢åŠŸèƒ½

#### ğŸ“Š è¡¨æ ¼åŠ¨æ€æ’åºåŠŸèƒ½
- **åŠŸèƒ½**: ç‚¹å‡»è¡¨å¤´å³å¯å¯¹ä»»æ„åˆ—è¿›è¡Œæ’åº
- **æ”¯æŒçš„æ’åºåˆ—**:
  - è‚¡ç¥¨ä»£ç ï¼ˆå­—æ¯é¡ºåºï¼‰
  - æ€»æˆäº¤é‡
  - C/P æˆäº¤æ¯”
  - æŒä»“é‡
  - C/P æŒä»“æ¯”
  - Put æˆäº¤é‡
  - Call æˆäº¤é‡
- **äº¤äº’ä½“éªŒ**:
  - é¼ æ ‡æ‚¬åœè¡¨å¤´æ—¶é«˜äº®æ˜¾ç¤º
  - ç‚¹å‡»ä¸€æ¬¡é™åºï¼Œå†æ¬¡ç‚¹å‡»å‡åº
  - å½“å‰æ’åºåˆ—æ˜¾ç¤ºé‡‘è‰²ç®­å¤´å›¾æ ‡ (â–² æˆ– â–¼)
  - æ’ååˆ—è‡ªåŠ¨é‡æ–°ç¼–å·

**æ•°æ®ç”Ÿæˆé€»è¾‘è¯´æ˜**:
1. Python åç«¯ï¼šæŒ‰æ€»æˆäº¤é‡é™åºæ’åˆ—å–å‰30ä¸ªticker
2. å®Œæ•´æ•°æ®ä»¥JSONæ ¼å¼ä¼ é€’åˆ°HTML
3. JavaScriptå®¢æˆ·ç«¯ï¼šå®ç°åŠ¨æ€æ’åºå’Œè¡¨æ ¼æ¸²æŸ“

**ä¿®æ”¹æ–‡ä»¶**:
- `src/report_generator.py`
  - æ·»åŠ  `table_data_json` å‚æ•°ä¼ é€’å®Œæ•´æ•°æ®
  - ä¿®æ”¹è¡¨å¤´æ·»åŠ  `sortable` classå’Œæ•°æ®å±æ€§
  - æ·»åŠ  `sortTable()` JavaScriptå‡½æ•°
  - æ·»åŠ  `renderTable()` åŠ¨æ€æ¸²æŸ“å‡½æ•°
  - æ·»åŠ CSSæ ·å¼ï¼š`.sortable`ã€`.sort-icon`ã€æ’åºçŠ¶æ€æ ·å¼

---

## 2025-10-30 (v2)

### ä¼˜åŒ–åŠŸèƒ½

#### ğŸ”„ æ™ºèƒ½ CSV ç¼“å­˜ç­–ç•¥
- **ç›˜ä¸­æ—¶æ®µ**: è‡ªåŠ¨é‡æ–°ä¸‹è½½ CSV ä»¥è·å–æœ€æ–°æ•°æ®
- **ç›˜å/ä¼‘å¸‚**: ä½¿ç”¨æœ¬åœ°ç¼“å­˜ï¼Œé¿å…é‡å¤ä¸‹è½½
- **æ™ºèƒ½åˆ¤æ–­**: æ ¹æ®ç¾ä¸œæ—¶é—´è‡ªåŠ¨è¯†åˆ«äº¤æ˜“æ—¶æ®µ
- **æ—¥å¿—ä¼˜åŒ–**: æ¸…æ™°æ˜¾ç¤ºä½¿ç”¨ç¼“å­˜æˆ–é‡æ–°ä¸‹è½½çš„åŸå› 

**ä¿®æ”¹æ–‡ä»¶**:
- `src/csv_handler.py`
  - å¯¼å…¥ `get_market_times` è·å–å¸‚åœºæ—¶æ®µä¿¡æ¯
  - ä¿®æ”¹ `download_csv()` æ·»åŠ æ™ºèƒ½ç¼“å­˜åˆ¤æ–­é€»è¾‘
  - ç›˜ä¸­åˆ é™¤æ—§ç¼“å­˜å¹¶é‡æ–°ä¸‹è½½
  - ç›˜å/ä¼‘å¸‚ç›´æ¥ä½¿ç”¨ç¼“å­˜

---

## 2025-10-30 (v1)

### æ–°å¢åŠŸèƒ½

#### 1. ğŸ“¦ CSV æ–‡ä»¶æœ¬åœ°ç¼“å­˜
- **åŠŸèƒ½**: è‡ªåŠ¨ä¿å­˜ä¸‹è½½çš„ CSV æ–‡ä»¶åˆ°æœ¬åœ°ç£ç›˜
- **ä½ç½®**: `data/YYYY-MM-DD_options_day_aggs.csv.gz`
- **ä¼˜åŠ¿**:
  - é¦–æ¬¡ä¸‹è½½åè‡ªåŠ¨ç¼“å­˜
  - ç¬¬äºŒæ¬¡è¿è¡Œç›´æ¥ä»æœ¬åœ°åŠ è½½ï¼ŒèŠ‚çœæ—¶é—´å’Œ API é…é¢
  - ä¿ç•™å†å²æ•°æ®ï¼Œä¾¿äºå›æº¯åˆ†æ
  - è‡ªåŠ¨å¿½ç•¥ Git æäº¤ï¼ˆå·²é…ç½® .gitignoreï¼‰

**ä¿®æ”¹æ–‡ä»¶**:
- `src/csv_handler.py`
  - æ–°å¢ `_get_local_csv_path()` - è·å–æœ¬åœ°æ–‡ä»¶è·¯å¾„
  - æ–°å¢ `_save_csv_to_disk()` - ä¿å­˜æ–‡ä»¶åˆ°ç£ç›˜
  - ä¿®æ”¹ `download_csv()` - æ”¯æŒæœ¬åœ°ç¼“å­˜æ£€æŸ¥å’Œä¿å­˜

#### 2. ğŸŒ å¤šæ—¶åŒºæ—¶é—´æ˜¾ç¤º
- **åŠŸèƒ½**: åŒæ—¶æ˜¾ç¤ºç¾ä¸œæ—¶é—´å’Œä¸œå…«åŒºæ—¶é—´
- **æ˜¾ç¤ºæ ¼å¼**:
  ```
  ğŸ”’ ç¾ä¸œæ—¶é—´: 2025-10-29 20:42:21 EDT | ä¸œå…«åŒºæ—¶é—´: 2025-10-30 08:42:21 | äº¤æ˜“æ—¶æ®µ: ä¼‘å¸‚ (Market Closed)
  ```

**ä¿®æ”¹æ–‡ä»¶**:
- `requirements.txt` - æ·»åŠ  `pytz>=2024.1` ä¾èµ–
- `src/utils.py` - æ–°å¢å¤šä¸ªæ—¶åŒºç›¸å…³å‡½æ•°:
  - `get_market_session()` - åˆ¤æ–­å½“å‰äº¤æ˜“æ—¶æ®µ
  - `get_market_session_display()` - è·å–æ—¶æ®µæ˜¾ç¤ºæ–‡æœ¬
  - `get_market_times()` - è·å–å¤šæ—¶åŒºæ—¶é—´ä¿¡æ¯
  - `format_market_time_html()` - æ ¼å¼åŒ– HTML æ˜¾ç¤º
  - æ›´æ–° `print_banner()` - ä½¿ç”¨æ–°çš„æ—¶åŒºæ˜¾ç¤º

#### 3. ğŸ“Š äº¤æ˜“æ—¶æ®µæ™ºèƒ½è¯†åˆ«
- **åŠŸèƒ½**: è‡ªåŠ¨è¯†åˆ«å½“å‰æ˜¯ç›˜å‰ã€ç›˜ä¸­ã€ç›˜åè¿˜æ˜¯ä¼‘å¸‚
- **æ—¶æ®µå®šä¹‰**ï¼ˆç¾ä¸œæ—¶é—´ï¼‰:
  - ğŸŒ… ç›˜å‰ (Pre-Market): 04:00 - 09:30
  - ğŸ“ˆ ç›˜ä¸­ (Market Hours): 09:30 - 16:00
  - ğŸŒ™ ç›˜å (After Hours): 16:00 - 20:00
  - ğŸ”’ ä¼‘å¸‚ (Market Closed): å…¶ä»–æ—¶é—´åŠå‘¨æœ«

**ä¿®æ”¹æ–‡ä»¶**:
- `src/report_generator.py`
  - å¯¼å…¥æ—¶åŒºè½¬æ¢å‡½æ•°
  - æ›´æ–° HTML æŠ¥å‘Šæ—¶é—´æ˜¾ç¤ºæ ¼å¼

### æµ‹è¯•ç»“æœ

âœ… æ‰€æœ‰åŠŸèƒ½æµ‹è¯•é€šè¿‡ï¼š
- âœ“ æ—¶åŒºè½¬æ¢åŠŸèƒ½æ­£å¸¸
- âœ“ äº¤æ˜“æ—¶æ®µåˆ¤æ–­å‡†ç¡®
- âœ“ CSV ä¿å­˜è·¯å¾„ç”Ÿæˆæ­£ç¡®
- âœ“ data/ ç›®å½•è‡ªåŠ¨åˆ›å»º

### ä½¿ç”¨è¯´æ˜

#### CSV ç¼“å­˜ç®¡ç†
```bash
# æŸ¥çœ‹å·²ç¼“å­˜çš„æ–‡ä»¶
ls -lh data/

# æ¸…ç†æ—§æ•°æ®ï¼ˆä¿ç•™æœ€è¿‘ 30 å¤©ï¼‰
find data/ -name "*.csv.gz" -mtime +30 -delete
```

#### æ‰‹åŠ¨æ¸…ç†ç¼“å­˜
```bash
# åˆ é™¤æ‰€æœ‰ç¼“å­˜
rm -rf data/*.csv.gz

# åˆ é™¤æŒ‡å®šæ—¥æœŸ
rm data/2025-10-29_options_day_aggs.csv.gz
```

### ä¸‹ä¸€æ­¥è®¡åˆ’
- [ ] æ·»åŠ å†å²æ•°æ®è¶‹åŠ¿åˆ†æ
- [ ] æ”¯æŒè‡ªå®šä¹‰æ—¶åŒºæ˜¾ç¤º
- [ ] CSV æ•°æ®å‹ç¼©ä¼˜åŒ–
